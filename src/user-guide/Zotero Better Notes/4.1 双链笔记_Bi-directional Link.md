4.1 双链笔记/Bi-directional Link

关于双链笔记的定义及其设计哲学，互联网上有大量参考材料，在此不再赘述。

为了更好地结合Zotero的文献管理功能，本插件并非完全遵循双链笔记的严格定义开发。

# 笔记链接

为了支持双链笔记，Better Notes为Zotero添加了笔记链接这一特性。通过形如zoter://note/的链接，支持笔记的跨库链接（例如，从个人库笔记链接到群组库笔记，或在不同群组库之间链接）。

笔记链接具有跨平台一致性，即只要账号对链接的笔记有权限访问（且内容已同步），就可以打开对应笔记。

笔记链接和Zotero的PDF、条目链接一样，可在Zotero内/外任意软件中使用，即使导出为markdown等其他格式，也可以从第三方软件跳回Zotero。

# 添加双链

## 在笔记编辑器中添加双链

在笔记编辑器中，顶部栏中央的花形图标专门用于添加双链。

直接点击图标，将在主笔记当前光标处添加一条正链（主笔记=>子笔记），当前笔记成为子笔记。同时，在当前子笔记末尾添加一条反链（子笔记=>主笔记）；

点击图标下方弹出窗口中的对应主笔记标题，将在主笔记对应层级的末尾插入正链；按住Shift后，弹出窗口变成淡蓝色，将在主笔记对应层级之前插入正链。

<img src="https://cdn.nlark.com/yuque/0/2022/png/32594373/1662108043491-48604234-a0eb-4b10-bc3f-1419f0d0e5e3.png" width="845" id="u2a36191f" class="ne-image"><img src="https://cdn.nlark.com/yuque/0/2022/png/32594373/1662108043450-21b717e0-a633-4147-9c52-210a3cfe6cfe.png" width="1939" id="ue6799ae6" class="ne-image">

🤔此处正链的格式由系统模板QuickInsert控制，反链格式由系统模板QuickBackLink控制，均支持用户自定义。详见[4.2 笔记模板/Note Template](https://zotero.yuque.com/books/share/f3fe159f-956c-4f10-ade3-c87559cacb60/un54wc)

## 通过标签添加双链

插件版本>=v0.7.2

为笔记或批注加上以`#`开头且与主笔记中节标题相同的标签时，会自动将该内容（笔记或批注）加入主笔记。例如，主笔记中有Relation一节，则为笔记或批注添加`#Relation`标签将会在主笔记的Relation一节添加双链。

💡如果标签为`##`，则将添加到主笔记的当前光标位置（若没有光标位置，则是末尾）。

若被标签的内容是笔记，则以笔记双链形式加入主笔记对应节末尾：

<img src="https://cdn.nlark.com/yuque/0/2022/png/32594373/1662204006361-ff83a70c-7696-44c5-b7c7-9de107fce136.png" width="1280" id="uc0fb3851" class="ne-image">

若被标签的内容是批注，则批注自身加入主笔记对应节末尾：

<img src="https://cdn.nlark.com/yuque/0/2022/png/32594373/1662203665180-5ad32be2-6740-4ff0-9369-536e679074a8.png" width="1273.5" id="ud1b0a139" class="ne-image">

## 手动添加双链

插件版本>=v0.7.1

手动复制笔记链接来构建双链，或者复制到外部应用。

<img src="https://cdn.nlark.com/yuque/0/2022/png/32594373/1662204724239-9287e187-1523-405e-932d-ebd41d23d167.png" width="584" id="uadad7b93" class="ne-image">

# 笔记链接格式

zotero://note/{库id}/{笔记id}/

## 链接参数

- ignore

- 类型：数字（0或1）
- 作用：控制导出时是否嵌入笔记内容。若ignore=1，则不嵌入。用于反链及已经嵌入过的链接。

- line

- 类型：数字
- 作用：控制笔记打开时转跳的行。默认为首行。